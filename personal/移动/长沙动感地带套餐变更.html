<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title>长沙动感地带品牌互转_网上营业厅_湖南移动</title>

    <script type="text/JavaScript" src="https://www.hn.10086.cn/v2009/js/yyt_log/pageViews.js"></script>

    <script type="text/JavaScript" src="https://www.hn.10086.cn/v2009/js/bottom.js"></script>

    <script type="text/JavaScript" src="https://www.hn.10086.cn/v2009/service/js/service_top_banner.js"></script>

    <script type="text/JavaScript" src="https://www.hn.10086.cn/v2009/service/js/service_left_nav.js"></script>

    <script type="text/JavaScript" src="https://www.hn.10086.cn/v2009/service/js/head_service.js"></script>

    <script type="text/JavaScript" src="https://www.hn.10086.cn/v2009/service/js/service_business.js"></script>

    <script type="text/JavaScript" src="https://www.hn.10086.cn/v2009/js/jquery.js"></script>

    <script type="text/JavaScript" src="https://www.hn.10086.cn/v2009/js/jquery.form.js"></script>

    <script type="text/JavaScript" src="https://www.hn.10086.cn/v2009/js/common.js"></script>

    <script type="text/JavaScript" src="https://www.hn.10086.cn/v2009/js/showDialogDiv.js"></script>

    <script type="text/JavaScript" src="https://www.hn.10086.cn/v2009/js/loginCommon.js"></script>

    <script type="text/JavaScript" src="https://www.hn.10086.cn/v2009/js/busiInfoQuery.js"></script>

    <script type="text/JavaScript" src="https://www.hn.10086.cn/v2009/js/busiRelatedQuery.js"></script>

    <script type="text/JavaScript" src="https://www.hn.10086.cn/v2009/js/busiMenuLeft.js"></script>

    <script type="text/JavaScript" src="https://www.hn.10086.cn/v2009/js/cookieUtil.js"></script>

    <script type="text/JavaScript" src="https://www.hn.10086.cn/v2009/js/publicUtil.js"></script>

    <script type="text/JavaScript" src="https://www.hn.10086.cn/v2009/js/common.js"></script>

    <script type="text/JavaScript" src="https://www.hn.10086.cn/v2009/js/satisfaction.js"></script>

</head>
<body>
    <form id="serviceForm" name="serviceForm" action="https://www.hn.10086.cn/service/business/csMzoneFeeChange.do"
    method="post">
    <div class="subnav_bj_l aboutus_bottom" id="operdiv">
        <div class="subnav_content_bl_bj" id="brandChangeDiv" name="operBusiDiv">
            <table width="100%" border="0" cellpadding="0" cellspacing="0" bgcolor="0">
                <tr>
                    <td colspan="2">
                        品牌套餐变更
                    </td>
                </tr>
                <tr>
                    <td width="176" align="right" class="fc1 bj">
                        现有品牌信息：
                    </td>
                    <td id="brandInfoTd" colspan="2">
                    </td>
                </tr>
                <tr>
                    <td align="right" rowspan="2" class="fc1 bj">
                        品牌资费信息介绍：
                    </td>
                    <td>
                        动感地带.校园计划08版
                    </td>
                    <td>
                        动感地带.时尚计划08版
                    </td>
                </tr>
                <tr>
                    <td>
                        &nbsp;&nbsp;&nbsp;&nbsp;月租:0元/月;来电显示: 5元/月;校园内0.20元/分钟，校园外0.36元/分钟;本地被叫:长株潭地区全免;漫游级别;全国漫游
                    </td>
                    <td>
                        &nbsp;&nbsp;&nbsp;&nbsp;月租:0元/月;来电显示: 5元/月;闲时本地主叫0.20元/分钟，忙时（每天17：00-21：00）本地主叫0.36元/分钟;本地被叫:长株潭地区全免;漫游级别;全国漫游
                    </td>
                </tr>
                <tr>
                    <td align="right" class="fc1 bj">
                        音乐套餐（必选包）：
                    </td>
                    <td id="musicPageInfoTd" colspan="2">
                    </td>
                </tr>
                <tr id="selectIdtr">
                    <td align="right" class="fc1 bj">
                        请选择校区
                    </td>
                    <td>
                        <input type="button" name="selButton" id="selButton" value="选 择" class="an" onclick="selectCompus();" />
                    </td>
                    <td>
                        <span id="selectedSchool"></span>
                    </td>
                </tr>
            </table>
            <input type="hidden" name="busiId" value="csMzoneFeeChange" />
            <input type="hidden" name="subId" value="" />
            <input type="hidden" name="operType" value="2" />
            <input type="hidden" name="operation" value="operation" />
            <input type="hidden" name="userNo" value="13549664433" />
            <input type="hidden" name="productId" id="productId" value="" />
            <input type="hidden" name="brandCode" id="brandCode" value="" />
            <input type="hidden" name="feesetCode" id="feesetCode" value="" />
            <input type="hidden" name="schoolCode" id="schoolCode" value="" />
        </div>
        <hr />
        <div class="subnav_content_bl_bj" id="OffersChangeDiv">
            <table id="openMzoneTcTable" width="100%" border="0" cellpadding="0" cellspacing="0"
                bgcolor="0">
                <tr>
                    <td>
                        可选优惠套餐变更
                    </td>
                </tr>
                <tr>
                    <td colspan="3" align="center" class="fB">
                        已开通服务项目状态
                    </td>
                </tr>
                <tr>
                    <td align="center" class="bj">
                        套餐名称
                    </td>
                    <td align="center" class="bj">
                        开始时间
                    </td>
                    <td align="center" class="bj">
                        结束时间
                    </td>
                </tr>
                <tr id="openMzoneTcTr" style="display: none;">
                    <td align="center" id="tcNameTD">
                    </td>
                    <td align="center" id="beginDateTD">
                    </td>
                    <td align="center" id="endDateTD">
                    </td>
                </tr>
            </table>
            <table width="100%" border="0" cellpadding="0" cellspacing="0" bgcolor="0">
                <tr>
                    <td width="176" align="right" class="fc1 bj">
                        可选套餐变更类型：
                    </td>
                    <td>
                        <select name="subFeeType" id="subFeeType" onchange="changeFeeSet(this.value)">
                        </select>
                    </td>
                </tr>
                <tr>
                    <td align="right" class="fc1 bj">
                        套餐名称：
                    </td>
                    <td id="myTD" align="left">
                    </td>
                </tr>
                <tr>
                    <td align="right" class="fc1 bj">
                        套餐资费：
                    </td>
                    <td id="tdFee" align="left">
                        <span id="divFee">&nbsp;</span>
                    </td>
                </tr>
                <tr>
                    <td align="right" class="fc1 bj">
                        选择办理：
                    </td>
                    <td>
                        <span id="operTypeDiv1">
                            <input type="checkbox" name="operType" id="opertype1" value="0" disabled />申请
                        </span><span id="operTypeDiv2">
                            <input type="checkbox" name="operType" id="opertype2" value="1" disabled />取消
                        </span>
                        <input type="hidden" id="feeCode" name="feeCode" value="">
                    </td>
                </tr>
            </table>
        </div>
    </div>
    </form>

    <script type="text/JavaScript">
        function cutoverTab(n) {
            var ulObj = $("#busiTabDiv").find("ul");
            if (ulObj.eq(n).attr("class") == "subnav_content_bl7_sy") {
                return;
            } else {
                ulObj.eq(n).attr("class", "subnav_content_bl7_sy");
            }
            if (n == 0) {
                ulObj.eq(1).attr("class", "subnav_content_odf");
                $("#brandChangeDiv").show();
                $("#OffersChangeDiv").hide();
                $("#brandChangeButDiv").show();
                $("#OffersChangeButDiv").hide();
            } else if (n == 1) {
                ulObj.eq(0).attr("class", "subnav_content_odf");
                $("#brandChangeDiv").hide();
                $("#OffersChangeDiv").show();
                $("#brandChangeButDiv").hide();
                $("#OffersChangeButDiv").show();
            }
        }

        var arrTypes;
        var arrCodes;
        var arrSubNames;
        var arrOperational;
        var endDateIsCurrMon;
        var arrNames;
        var arrRemark;
        var arrFee;
        var divs = 0;
        var chkApply = document.getElementById("opertype1");
        var chkCancel = document.getElementById("opertype2");
        var mzoneType = "";
        var arrTypesUnique = new Array();
        var isNewSet = "";

        var feeCode = "";
        var prices = new Array();

        var schoolList;
        var optionalFee;

        //init(document.form1.subFeeType);

        var debug1 = 0, debug2 = 0;

        function init(sel_subtype) {
            var temp = "";
            sel_subtype.options.add(new Option("请选择...", "0"));
            for (var i = 0; i < arrTypes.length; i++) {
                if (arrTypes[i] != temp) {
                    temp = arrTypes[i];
                    arrTypesUnique[divs] = arrTypes[i];
                    divs++;
                    sel_subtype.options.add(new Option(arrNames[i], divs));
                }
            }

            insertDiv();
        }

        function insertDiv() {
            var container = document.getElementById("myTD");
            var i, j, divt, chkbx;
            for (i = 1; i <= divs; i++) {
                divt = document.createElement("span");
                divt.setAttribute("id", "div_tc" + i);
                divt.style.display = "none";
                container.appendChild(divt);

                for (j = 0; j < arrSubNames.length; j++) {
                    if (arrTypes[j] == arrTypesUnique[i - 1]) {
                        //if(arrCodes[j] == "31052088" ||arrCodes[j] == "52081"
                        // || arrCodes[j] == "52082" || arrCodes[j] == "53001" || arrCodes[j] == "53002"){


                        if (isSingleType(j)) {
                            var divContainer = document.createElement("span");
                            chkbx = document.createElement("input");
                            chkbx.setAttribute("type", "hidden");
                            chkbx.setAttribute("id", "chk_tc" + i + "_" + (j + 1));
                            chkbx.setAttribute("name", "subId");
                            chkbx.setAttribute("value", arrCodes[j]);
                            chkbx.setAttribute("value1", i);
                            chkbx.setAttribute("value2", j + 1);
                            // chkbx.onclick = function() {if(this.checked) selectName(this.getAttribute("value1") , this.getAttribute("value2"));};
                            divContainer.appendChild(chkbx);
                            divContainer.appendChild(document.createTextNode(arrSubNames[j]));
                            divt.appendChild(divContainer);
                            var br = document.createElement("br");
                            divt.appendChild(br);
                        } else {
                            var divContainer = document.createElement("span");
                            chkbx = document.createElement("input");
                            chkbx.setAttribute("type", "checkbox");
                            chkbx.setAttribute("id", "chk_tc" + i + "_" + (j + 1));
                            chkbx.setAttribute("name", "subId");
                            chkbx.setAttribute("value", arrCodes[j]);
                            chkbx.setAttribute("value1", i);
                            chkbx.setAttribute("value2", j + 1);
                            chkbx.onclick = function() { if (this.checked) selectName(this.getAttribute("value1"), this.getAttribute("value2"), this.getAttribute("value")); };
                            divContainer.appendChild(chkbx);
                            divContainer.appendChild(document.createTextNode(arrSubNames[j]));
                            divt.appendChild(divContainer);
                            var br = document.createElement("br");
                            divt.appendChild(br);
                        }

                    }
                }
            }
        }
        //根据下拉框的值获取套餐类型编码
        function getFeeTypeBySelectValue(type) {
            var temp = "";
            for (var i = 0; i < arrTypes.length; i++) {
                if (arrTypes[i] != temp) {
                    temp = arrTypes[i];
                    type--;
                    if (type == 0) {
                        return arrTypes[i];
                    }
                }
            }

        }

        function getFee1(type) {

            var feeType = getFeeTypeBySelectValue(type);
            var remarkStr = "";
            for (var i = 0; i < arrTypes.length; i++) {
                if (arrTypes[i] == feeType) {
                    if (arrRemark[i] != null && arrRemark[i] != "null" && arrRemark[i] != "") {
                        remarkStr += arrRemark[i] + "<br/>";
                    }
                }
            }
            return remarkStr;
        }


        function changeFeeSet(FeeType) {
            document.getElementById("feeCode").value = "";
            debug1 = FeeType;
            document.getElementById("divFee").innerHTML = getFee1(FeeType);
            var i, j, counter;

            for (i = 1; i <= divs; i++) {
                document.getElementById("div_tc" + i).style.display = "none";
                for (j = 1; j <= arrTypes.length; j++) {
                    if (document.getElementById("chk_tc" + i + "_" + j) != null) {
                        document.getElementById("chk_tc" + i + "_" + j).disabled = true;
                        document.getElementById("chk_tc" + i + "_" + j).checked = false;
                    }
                }
            }


            var num = parseInt(FeeType);
            if (document.getElementById("div_tc" + num) != null)
                document.getElementById("div_tc" + num).style.display = "block";

            for (i = 1; i <= arrTypes.length; i++) {
                if (document.getElementById("chk_tc" + num + "_" + i) != null) {
                    document.getElementById("chk_tc" + num + "_" + i).disabled = false;
                }
            }
            for (i = 0; i < arrTypes.length; i++) {
                if (arrTypesUnique[FeeType - 1] == arrTypes[i]) {
                    if (isSingleType(i)) {
                        changeSubmit(i + 1);
                    } else {
                        chkApply.disabled = false;
                        chkCancel.disabled = false;
                    }
                }
            }
        }

        function isSingleType(index) {
            //判断该类型是否有多个套餐 false 多；true 单	
            var time = 0;
            for (i = 0; i < arrTypes.length; i++) {
                if (arrTypes[index] == arrTypes[i]) {
                    time++;
                    if (time == 2) {
                        return false;
                    }
                }
            }
            return true;
        }

        function isNameSelected() {
            for (i = 1; i <= divs; i++) {
                for (j = 1; j <= arrTypes.length; j++) {
                    if (document.getElementById("chk_tc" + i + "_" + j) != null) {
                        if (document.getElementById("chk_tc" + i + "_" + j).checked) return true;
                    }
                }
            }
            return false;
        }

        function selectName(type, name, feeCode) {
            document.getElementById("feeCode").value = feeCode;
            var i;
            for (i = 1; i <= arrTypes.length; i++) {
                if (document.getElementById("chk_tc" + type + "_" + i) != null) {
                    document.getElementById("chk_tc" + type + "_" + i).checked = false;
                }
            }
            document.getElementById("chk_tc" + type + "_" + name).checked = true;
            changeSubmit(name);

            //20080328紧急需求,少于5分的短信套餐不能申请	   
            feeCode = document.getElementById("chk_tc" + type + "_" + name).value;
            if (feeCode == "52078" || feeCode == "52079" ||
							feeCode == "52080" || feeCode == "31054375" || feeCode == "31054374" ||
							feeCode == "31054375" || feeCode == "31054376" || feeCode == "31054377" ||
							feeCode == "31210109" || feeCode == "31210110" || feeCode == "31210111" ||
							feeCode == "31210112" || feeCode == "31210113" || feeCode == "31000275" ||
							feeCode == "31052085" || feeCode == "31052086" || feeCode == "31052087" ||
							feeCode == "52109") {
                chkApply.disabled = true;
                chkApply.checked = false;
            }
        }

        function changeSubmit(name) {
            //alert("changeSubmit, name=" + name + " operational=" + arrOperational[name-1]);
            if (arrOperational[name - 1] == "0" && endDateIsCurrMon[name - 1] == "1") {//某种套餐已开通，但结束时间不是当前月，则不允许再申请
                chkApply.disabled = true;
                chkCancel.disabled = false;
                chkApply.checked = false;
            } else if (arrOperational[name - 1] == "0" && endDateIsCurrMon[name - 1] == "0") {//某种套餐已开通，但结束时间是当前月，则允许再申请
                chkApply.disabled = false;
                chkCancel.disabled = true;
                chkCancel.checked = false;
            } else if (arrOperational[name - 1] == "1") {
                chkApply.disabled = false;
                chkCancel.disabled = true;
                chkCancel.checked = false;
            } else {
                chkApply.disabled = true;
                chkCancel.disabled = true;
                chkApply.checked = false;
                chkCancel.checked = false;
            }
        }
        function isNameSelected() {
            for (var i = 1; i <= divs; i++) {
                for (var j = 1; j <= arrTypes.length; j++) {
                    if (document.getElementById("chk_tc" + i + "_" + j) != null) {
                        if (document.getElementById("chk_tc" + i + "_" + j).checked) return true;
                    }
                }
            }
            return false;
        }

        function getSelectedName() {
            for (var i = 1; i <= divs; i++) {
                if (document.getElementById("div_tc" + i).style.display == "block") {
                    for (var j = 1; j <= arrTypes.length; j++) {
                        if (document.getElementById("chk_tc" + i + "_" + j) != null) {
                            if (isSingleType2(j - 1)) {
                                // alert("single:"+arrSubNames[j-1]+";j="+j+";price="+getPrice(j-1));
                                return [arrSubNames[j - 1], getPrice(j - 1)];
                            }
                            //alert("1111222222222="+"|chk_tc" + i + "_" + j+"|"+document.getElementById("chk_tc" + i + "_" + j));
                            if (document.getElementById("chk_tc" + i + "_" + j).checked) {
                                // alert("checkbox:"+arrSubNames[j-1]+";j="+j+";price="+getPrice(j-1));
                                return [arrSubNames[j - 1], getPrice(j - 1)];
                            }
                        }
                    }
                }
            }
        }

        function getPrice(j) {
            for (i = 0; i < prices.length; i++) {
                if (prices[i].length > 0) {
                    return prices[i][j];
                }
            }
        }

        function isSingleType2(index) {
            //判断该类型是否有多个套餐 false 多；true 单	
            var time = 0;
            for (var i = 0; i < arrTypes.length; i++) {
                if (arrTypes[index] == arrTypes[i]) {
                    time++;
                    if (time >= 2) {
                        return false;
                    }
                }
            }
            return true;
        }
        //业务预处理，加载业务状态，以及二次确认信息
        function getBusiStatus(busiId) {
            var json = $.ajax({
                url: "https://www.hn.10086.cn/v2009/service/ajax/business/csMzoneFeeChange.jsp",
                cache: false,
                dataType: "json",
                type: "post",
                beforeSend: function(XMLHttpRequest) {
                    $("div[name='operBusiDiv']").hide();
                    loadProgressBar(1, "正在获取业务状态，请稍候...");
                    $("#submitbtn").attr("disabled", "disabled");
                },
                success: function(json) {
                    if (json.succeed == 'true') {
                        var cando = json.cando;
                        if (cando == 0) {
                            var feeSetdata = json.feeSetBeans
                            $.each(feeSetdata, function(i, n) {
                                var row = $("#openMzoneTcTr").clone();
                                row.show();
                                row.find("#tcNameTD").text(n.feeSetName);
                                row.find("#beginDateTD").text(n.feeSetStartDate);
                                row.find("#endDateTD").text(n.feeSetEndDate);
                                row.appendTo("#openMzoneTcTable"); //添加到模板的容器中
                            });
                            $("input:hidden[name='productId']").val(json.productId);
                            $("input:hidden[name='brandCode']").val(json.brandCode);
                            $("input:hidden[name='feesetCode']").val(json.feesetCode);
                            $("#brandInfoTd").html(json.brandInfo);
                            $("#musicPageInfoTd").html(json.info);
                            $("#submitbtn").val(json.buttonStr);
                            arrTypes = eval(json.arrTypes);
                            arrCodes = eval(json.arrCodes);
                            arrSubNames = eval(json.arrSubNames);
                            arrOperational = eval(json.arrOperational);
                            endDateIsCurrMon = eval(json.endDateIsCurrMon);
                            arrNames = eval(json.arrNames);
                            arrRemark = eval(json.arrRemark);
                            arrFee = eval(json.arrFee);
                            mzoneType = json.mzoneType;
                            isNewSet = (arrSubNames.length == 0 ? false : arrSubNames[0].substring(0, 2) == "动感");
                            //需不需要选择校区
                            if (json.pid == '31880003') {
                                $("#selectIdtr").show();
                                schoolList = json.schoolList;
                            }
                            optionalFee = json.optionalFee;
                            init(document.serviceForm.subFeeType);
                        } else {
                            showQueryFail('尊敬的客户，您不能办理该业务，感谢您的关注。（目标客户：“长沙动感地带.校园计划08版”、“长沙动感地带.时尚计划08版”）', 1);
                            $("#operdiv").hide();
                        }
                    } else {
                        if (json.errCode == "-3") {//办理超时，未登陆状态
                            showLoginDialogDiv("csMzoneFeeChange"); //显示登陆框
                        } else {
                            showQueryFail('获取状态失败，请稍后再试！');
                            $("#operdiv").hide();
                        }
                    }
                },
                complete: function(XMLHttpRequest, textStatus) {
                    $("div[id='brandChangeDiv']").show();
                    $("#queryProgressBarDiv").hide();
                    $("#submitbtn").attr("disabled", "");
                },
                error: function(textStatus) {
                    showQueryFail("系统忙，请稍后再试！");
                    $("#operdiv").hide();
                }
            });
        }


        function checkOptional() {

            var sum = 0;
            for (var i = 0; i < document.serviceForm.optionalPrivilege.length; i++) {
                if (document.serviceForm.optionalPrivilege[i].checked) {
                    var val = Number(document.serviceForm.optionalPrivilege[i].value);
                    sum += val;
                }
            }
            if (sum > optionalFee) {
                alert("您所的选优惠金额已大于必选套餐可选数据优惠金额,超出部分要另外付费用。");
            }

        }

        function selectCompus() {

            if (document.getElementById("compusDiv")) {
                $("#compusDiv").show();
            } else {
                var offset = $("#selButton").offset();
                var str = "";
                $.each(schoolList, function(i, n) {
                    str += "<tr><td align='left' bgcolor='#ffffff'>&nbsp;&nbsp;<input name='school' type='radio' value='" + n.schoolName + "|" + n.sclhoolCode + "'/>" + n.schoolName + "</td></tr>";
                });
                //alert( "left: " + offset.left + ", top: " + offset.top );
                $("<div id='compusDiv' style='display: block;z-index: 150; position: absolute;'></div>")
			.html('<table width="377px"  border="1" cellpadding="1" cellspacing="0" bordercolorlight="#5E9BF7" bordercolordark="#FFFFFF">'
			+ '<tr bgcolor="#E0F3FC"><td width="25%">学校筛选</td><td align="left">&nbsp;<input type="text" id="schoolName" name="schoolName" value=""/>'
			+ '&nbsp;&nbsp;<input type="button" name="filter" id="filter" class="yyt_btup" value="筛选" onClick="filterCompus();"/></td>'
			+ '<td with="1%"><span onClick="javascript:void(HideCompusDiv())" alt="关闭" style="cursor: pointer;">×</span></td><tr>'
			+ '<tr><td align="left" colspan="3" bgcolor="#ffffff">&nbsp;请选择您转入的校区：'
			+ '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<input type="button" name="okButton" class="yyt_btup" value="确定" onClick="filterOk();"/></td></tr>'
			+ '</table>').appendTo("body");
                $("#compusDiv").append($("<div id='compusDiv2' style='display: block;z-index: 150; position: absolute;height:256px;overflow-y:auto;'></div>")
			.html('<table width="377px"  border="1" cellpadding="1" cellspacing="0" bordercolorlight="#5E9BF7" bordercolordark="#FFFFFF">'
			+ str
			+ '</table>'));
                // var position = getOffsetPositionObj(document.getElementById("selButton"));
                var divid = document.getElementById("compusDiv");
                //$("#compusDiv").attr("style","left:"+$("#selButton").width()+"px");
                //$("#compusDiv").attr("style","top:"+$("#selButton").height()+"px");
                var left = offset.left + $("#selButton").width()
                var top = offset.top + $("#selButton").height()
                divid.style.left = left + "px";
                divid.style.top = top + "px";
            }

        }

        function filterCompus() {
            var schoolName = document.getElementById("schoolName").value;
            var json = $.ajax({
                //请求地址
                url: "https://www.hn.10086.cn/v2009/service/ajax/business/selectCompus.jsp?" + "schoolName=" + encodeURIComponent(encodeURIComponent(schoolName)),
                //是否缓存数据
                cache: false,
                dataType: "json",
                type: "post",
                beforeSend: function(XMLHttpRequest) {
                    $("div[name='operBusiDiv']").hide();
                    loadProgressBar(1, "正在获取状态，请稍候...");
                    $("input:button").attr("disabled", "disabled");
                    $("input:submit").attr("disabled", "disabled");
                },
                complete: function(XMLHttpRequest, textStatus) {
                    $("div[name='operBusiDiv']").show();
                    $("#queryProgressBarDiv").hide();
                },
                //成功后的回调函数
                success: function(json) {
                    var list = json.schoolList;
                    //alert(list.length);
                    var str = '<table width="377px"  border="1" cellpadding="1" cellspacing="0" bordercolorlight="#5E9BF7" bordercolordark="#FFFFFF">';
                    if (list.length > 0) {
                        for (var i = 0; i < list.length; i++) {
                            str += '<tr><td align="left" bgcolor="#ffffff">&nbsp;&nbsp;<input name="school" type="radio" value="' + list[i].schoolName + '|' + list[i].schoolCode + '"/>' + list[i].schoolName + '</td></tr>';
                        }
                    } else {
                        str += '<tr><td align="center" bgcolor="#ffffff" style="color:red">对不起，暂无相关信息。</td></tr>';
                    }
                    str += "</table>";
                    $("#compusDiv2").html(str);
                    $("input:button").attr("disabled", "");
                    $("input:submit").attr("disabled", "");
                },
                error: function(textStatus) {
                    $("#compusDiv2").html("系统忙，请稍后再试。");
                    $("#filter").attr("disabled", "");
                }
            });
        }

        function filterOk() {

            var rads = document.getElementsByName("school");
            var checkVal = "";
            for (var i = 0; i < rads.length; i++) {
                if (rads[i].checked) {
                    checkVal = rads[i].value;
                    break;
                }
            }
            //alert(checkVal);
            if (checkVal == "") {
                messaeDiv("请选择您转入的校区");
            } else {
                $("#selectedSchool").html(checkVal.substring(0, checkVal.indexOf("|")));
                // document.getElementById("selectedSchool").innerText=checkVal.substring(0,checkVal.indexOf("|"));
                document.serviceForm.schoolCode.value = checkVal.substring(checkVal.indexOf("|") + 1);
                HideCompusDiv();
                //alert($("input:radio[name='school'][checked='true']").val());
            }
        }

        function HideCompusDiv() {
            $("#compusDiv").hide();
        }

        function sub1() {

            if (document.serviceForm.productId.value == "31880002") {
                if (document.serviceForm.schoolCode.value == "") {
                    mesageDiv("请选择您转入的校区");
                    return false;
                } else {
                    portal('csMzoneFeeChange', "您品牌由“动感地带时尚计划08版”转为“动感地带校园计划08版”", '您确认将您品牌由“动感地带时尚计划08版”转为“动感地带校园计划08版”吗？', function() {//该方法在点击确认之后，提交表单之前执行
                        document.serviceForm.subId.value = "brandFeeSetChange";
                        document.serviceForm.operType.value = "2";
                    });
                }
            }
            if (document.serviceForm.productId.value == "31880003") {
                portal('csMzoneFeeChange', "您品牌由“动感地带校园计划08版”转为“动感地带时尚计划08版”", '您确认将您品牌由“动感地带校园计划08版”转为“动感地带时尚计划08版”吗？', function() {
                    document.serviceForm.schoolCode.value = "31180001";
                });
            }
        }

        function sub2() {

            if (document.serviceForm.subFeeType.value == "0") {
                messageDiv("请选择套餐类型。");
                return false;
            }

            var FeeType = document.serviceForm.subFeeType.value;
            if (!isNameSelected()) {
                for (i = 0; i < arrTypes.length; i++) {
                    if (arrTypesUnique[FeeType - 1] == arrTypes[i]) {
                        if (!isSingleType(i)) {
                            messageDiv("请选择套餐名称。");
                            return false;
                        }
                    }
                }
            }
            if (!document.getElementById("opertype1").checked && !document.getElementById("opertype2").checked) {
                messageDiv("请选择对应的业务办理类型！");
                return false;
            }

            var feeType = arrTypesUnique[document.serviceForm.subFeeType.value - 1];
            var feeCode = document.getElementById("feeCode").value;
            if (feeCode == "") {
                //套餐编码为空,属没有多选框的套餐.根据套餐类型编码获取套餐编码
                var subFeeType = document.getElementById("subFeeType");
                //1.获取下拉框的值
                var type = ""; //下拉框的值
                for (var i = 0; i < subFeeType.length; i++) {
                    if (subFeeType.options[i].selected) {
                        type = subFeeType.options[i].value;
                    }
                }
                //2.获取类型编码			
                var feeType = getFeeTypeBySelectValue(type); //类型编码
                //3.获取套餐编码			
                for (i = 0; i < arrTypes.length; i++) {
                    if (arrTypes[i] == feeType) {
                        feeCode = arrCodes[i]
                    }
                }
            }
            //根据套餐编码获取资费及名称			
            var fee = "";
            var name = "";
            for (i = 0; i < arrCodes.length; i++) {
                if (arrCodes[i] == feeCode) {
                    fee = arrFee[i];
                    name = arrSubNames[i];
                }
            }
            //alert("feeCode="+feeCode);		
            if (document.getElementById("opertype1").checked) {
                portal('csMzoneFeeChange', "开通“" + name + "”业务", "您即将开通“" + name + "”业务，月功能费" + fee + "元，您确认办理吗？", function() {
                    document.serviceForm.operType.value = "0";
                    document.serviceForm.feesetCode.value = feeCode;
                    document.serviceForm.subId.value = "selectFeeSetChange";
                });
            } else if (feeCode == "52078" || feeCode == "52079" ||
			feeCode == "52080" || feeCode == "31054375" || feeCode == "31054374" ||
			feeCode == "31054375" || feeCode == "31054376" || feeCode == "31054377" ||
			feeCode == "31210109" || feeCode == "31210110" || feeCode == "31210111" ||
			feeCode == "31210112" || feeCode == "31210113" || feeCode == "31000275" ||
			feeCode == "31052085" || feeCode == "31052086" || feeCode == "31052087" ||
			feeCode == "52109") {
                if (document.getElementById("opertype2").checked) {
                    portal('csMzoneFeeChange', "取消“" + name + "”业务", "根据国家相关政策，为了有效抑制垃圾短信的泛滥，长沙移动响应国家号召，将折合单价低于5分的短信套餐全部停办，您取消后将不允许再次申请，您确认取消吗？", function() {
                        document.serviceForm.operType.value = "1";
                        document.serviceForm.feesetCode.value = feeCode;
                        document.serviceForm.subId.value = "selectFeeSetChange";
                    });
                }

            } else if (document.getElementById("opertype2").checked) {
                portal('csMzoneFeeChange', "取消“" + name + "”业务", "您确定取消“" + name + "”业务吗？", function() {
                    document.serviceForm.operType.value = "1";
                    document.serviceForm.feesetCode.value = feeCode;
                    document.serviceForm.subId.value = "selectFeeSetChange";
                });
            }
        } 
					
    </script>

</body>
</html>
